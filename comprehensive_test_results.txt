/media/liuyu/DataDrive/WWW2026_demo/stindex/stindex/core/extractor.py:12: LangChainDeprecationWarning: As of langchain-core 0.3.0, LangChain uses pydantic v2 internally. The langchain_core.pydantic_v1 module was a compatibility shim for pydantic v1, and should no longer be used. Please update the code to import from Pydantic directly.

For example, replace imports like: `from langchain_core.pydantic_v1 import BaseModel`
with: `from pydantic import BaseModel`
or the v1 compatibility namespace if you are working in a code base that has not been fully upgraded to pydantic 2 yet. 	from pydantic.v1 import BaseModel

  from stindex.extractors.temporal import TemporalExtractor
`torch_dtype` is deprecated! Use `dtype` instead!
====================================================================================================
STIndex Comprehensive Capability Test
====================================================================================================

Loading model...
Loading model from: Qwen/Qwen3-8B
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  2.47it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:01,  2.41it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:01<00:00,  2.40it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:01<00:00,  2.60it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  3.44it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  2.93it/s]
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
`generation_config` default values have been modified to match model-specific defaults: {'do_sample': True, 'top_k': 20, 'bos_token_id': 151643, 'eos_token_id': [151645, 151643]}. If this is not desired, please set these values explicitly.
Model loaded successfully on auto
✓ Model loaded


====================================================================================================
第1部分: 时间提取能力测试
====================================================================================================

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.1 显式年份的绝对日期
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The project started on January 15, 2020, was paused on March 20, 2021, and resumed on September 5, 2022.

时间实体 (3 个):
  • 'January 15, 2020' → 2020-01-15 [date]
  • 'March 20, 2021' → 2021-03-20 [date]
  • 'September 5, 2022' → 2022-09-05 [date]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.2 无年份日期 - 年份推断
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: In 2023, the conference began on March 10. The workshop was on March 11, and the closing ceremony happened on March 12.

时间实体 (4 个):
  • '2023' → 2023-10-13 [date]
  • 'March 10' → 2023-03-10 [date]
  • 'March 11' → 2023-03-11 [date]
  • 'March 12' → 2023-03-12 [date]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.3 日期区间
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The exhibition will run from May 1, 2024 to May 31, 2024.

时间实体 (2 个):
  • 'May 1, 2024' → 2024-05-01 [date]
  • 'May 31, 2024' → 2024-05-31 [date]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.4 混合日期格式
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The event on 2024-06-15 follows the announcement from June 1, 2024, and precedes the deadline of July 15, 2024.

时间实体 (3 个):
  • '2024-06-15' → 2024-06-15 [date]
  • 'June 1, 2024' → 2024-06-01 [date]
  • 'July 15, 2024' → 2024-07-15 [date]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.5 相对时间表达
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The meeting was yesterday, the report is due tomorrow, and the review happens next week.

时间实体 (3 个):
  • 'yesterday' → 2025-10-12T21:15:33.592010 [relative]
  • 'tomorrow' → 2025-10-14T21:15:33.592010 [relative]
  • 'next week' → 2025-10-20T21:15:33.592010 [relative]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.6 带时刻的日期
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The webinar starts at 2:00 PM on March 15, 2024.

时间实体: 无

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.7 持续时间
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The training program lasts 3 weeks.

时间实体 (1 个):
  • '3 weeks' → P3W [duration]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.8 复杂时间上下文
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The study began in January 2020, was interrupted in March 2020 due to COVID-19, and resumed in September 2021.

时间实体 (3 个):
  • 'January 2020' → 2020-01-13 [date]
  • 'March 2020' → 2020-03-13 [date]
  • 'September 2021' → 2021-09-13 [date]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.9 跨年区间
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The study ran from December 2022 to February 2023.

时间实体 (2 个):
  • 'December 2022' → 2022-12-13 [date]
  • 'February 2023' → 2023-02-13 [date]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[时间] 1.10 历史日期
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: World War II ended on September 2, 1945. The Berlin Wall fell on November 9, 1989.

时间实体 (2 个):
  • 'September 2, 1945' → 1945-09-02 [date]
  • 'November 9, 1989' → 1989-11-09 [date]

空间实体 (1 个):
  • 'The Berlin Wall' → (51.4964° N, 0.1083° W)

====================================================================================================
第2部分: 空间提取能力测试
====================================================================================================

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.1 主要世界城市
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The tour includes stops in Paris, Tokyo, New York, and Sydney.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: includes stops [type=value_error, input_value='includes stops', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.2 城市+国家上下文
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The conference has venues in Berlin, Germany; Toronto, Canada; and Melbourne, Australia.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: has venues [type=value_error, input_value='has venues', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.3 歧义地名消歧 - Springfield
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: Springfield, Illinois is the state capital. Springfield, Massachusetts has a different history.

时间实体: 无

空间实体 (4 个):
  • 'Springfield' → (39.7990° N, 89.6440° W)
  • 'Illinois' → (40.0797° N, 89.4337° W)
  • 'Springfield' → (39.7990° N, 89.6440° W)
  • 'Massachusetts' → (41.5461° N, 88.1165° W)

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.4 州和地区
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: California, Texas, and Florida are the most populous US states.

时间实体: 无

空间实体 (4 个):
  • 'California' → (29.7181° N, 94.9980° W)
  • 'Texas' → (37.3355° N, 91.9808° W)
  • 'Florida' → (33.6504° N, 97.2053° W)
  • 'US' → (37.3355° N, 91.9808° W)

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.5 地标
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The Eiffel Tower in Paris and the Statue of Liberty in New York are iconic landmarks.

时间实体: 无

空间实体 (4 个):
  • 'The Eiffel Tower' → (36.2870° N, 88.3015° W)
  • 'Paris' → (33.6618° N, 95.5555° W)
  • 'the Statue of Liberty' → (16.3989° N, 120.6171° E)
  • 'New York' → (43.1562° N, 75.8450° W)

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.6 同国多城市
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The Australian tour covers Sydney, Melbourne, Brisbane, Perth, and Adelaide.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: covers [type=value_error, input_value='covers', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.7 小城镇+州上下文
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The study was conducted in Boulder, Colorado and Ann Arbor, Michigan.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: in Boulder, Colorado and Ann Arbor, Michigan [type=value_error, input_value='in Boulder, Colorado and Ann Arbor, Michigan', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.8 非洲城市
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The research team visited Lagos, Nigeria; Nairobi, Kenya; and Cairo, Egypt.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: visited [type=value_error, input_value='visited', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.9 亚洲城市
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The company has offices in Singapore, Seoul, Bangkok, and Mumbai.

时间实体: 无

空间实体 (3 个):
  • 'Singapore' → (37.5684° N, 126.9777° E)
  • 'Seoul' → (37.5667° N, 126.9783° E)
  • 'Bangkok' → (13.7253° N, 100.5796° E)

────────────────────────────────────────────────────────────────────────────────────────────────────
[空间] 2.10 欧洲首都
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The summit rotates between Brussels, Geneva, Vienna, and Copenhagen.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: rotates between [type=value_error, input_value='rotates between', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

====================================================================================================
第3部分: 时空联合提取测试
====================================================================================================

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.1 新闻报道 - 飓风
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: On August 29, 2005, Hurricane Katrina made landfall near New Orleans, Louisiana. By August 31, the storm had moved through Mississippi.

时间实体 (2 个):
  • 'August 29, 2005' → 2005-08-29 [date]
  • 'August 31' → 2005-08-31 [date]

空间实体 (3 个):
  • 'New Orleans' → (29.9807° N, 90.1107° W)
  • 'Louisiana' → (29.9807° N, 90.1107° W)
  • 'Mississippi' → (33.9757° N, 89.6814° W)

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.2 旅行行程
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: We'll arrive in Rome on June 5, 2024, stay three days, then travel to Florence on June 8.

时间实体: 无

空间实体 (2 个):
  • 'Rome' → (40.9814° N, 91.6824° W)
  • 'Florence' → (34.7998° N, 87.6773° W)

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.3 会议公告
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The International AI Conference will be held in Singapore from September 15-20, 2024.

时间实体: 无

空间实体 (1 个):
  • 'Singapore' → (1.3571° N, 103.8195° E)

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.4 历史事件 - 登月
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: On July 20, 1969, Apollo 11 landed on the Moon.

时间实体 (1 个):
  • 'July 20, 1969' → 1969-07-20 [date]

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.5 商业扩张时间线
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The company opened its Tokyo office in March 2020, followed by Shanghai in July 2020.

时间实体 (2 个):
  • 'March 2020' → 2020-03-13 [date]
  • 'July 2020' → 2020-07-13 [date]

空间实体 (2 个):
  • 'Tokyo' → (35.6769° N, 139.7639° E)
  • 'Shanghai' → (31.2323° N, 121.4691° E)

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.6 科研野外考察
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The expedition began in Nairobi, Kenya on February 1, 2023. Researchers spent two weeks in the Serengeti.

时间实体 (2 个):
  • 'February 1, 2023' → 2023-02-01 [date]
  • 'two weeks' → 2025-09-29 [date]

空间实体 (2 个):
  • 'Nairobi' → (1.2890° S, 36.8173° E)
  • 'Kenya' → (1.4420° N, 38.4314° E)

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.7 体育赛事
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The 2026 FIFA World Cup will be jointly hosted by the United States, Canada, and Mexico from June 11 to July 19, 2026.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: 2026 FIFA World Cup [type=value_error, input_value='2026 FIFA World Cup', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.8 气候事件 - PDF示例
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: On March 15, 2022, a strong cyclone hit the coastal areas near Broome, Western Australia and later moved inland by March 17.

时间实体 (2 个):
  • 'March 15, 2022' → 2022-03-15 [date]
  • 'March 17' → 2022-03-17 [date]

空间实体 (2 个):
  • 'Broome' → (17.9567° S, 122.2240° E)
  • 'Western Australia' → (25.2303° S, 121.0187° E)

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.9 政治事件 - 峰会
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The G20 Summit took place in Bali, Indonesia on November 15-16, 2022.

时间实体: 无

空间实体 (2 个):
  • 'Bali' → (8.2271° S, 115.1919° E)
  • 'Indonesia' → (2.4834° S, 117.8903° E)

────────────────────────────────────────────────────────────────────────────────────────────────────
[联合] 3.10 自然灾害时间线
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The earthquake struck off the coast of Sumatra on December 26, 2004. The tsunami affected Thailand and Sri Lanka.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: Thailand and Sri Lanka [type=value_error, input_value='Thailand and Sri Lanka', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

====================================================================================================
第4部分: 边界情况测试
====================================================================================================

────────────────────────────────────────────────────────────────────────────────────────────────────
[边界] 4.1 无时空信息
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The algorithm uses machine learning to optimize performance.

时间实体: 无

空间实体: 无

────────────────────────────────────────────────────────────────────────────────────────────────────
[边界] 4.2 密集信息
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: Between January 5 and January 10, 2024, the team visited Paris, London, Berlin, and Amsterdam.

Warning: Could not normalize interval 'Between January 5 and January 10, 2024', skipping
时间实体 (2 个):
  • 'January 5' → 2024-01-05 [date]
  • 'January 10, 2024' → 2024-01-10 [date]

空间实体 (4 个):
  • 'Paris' → (44.8145° N, 20.4589° E)
  • 'London' → (51.5156° N, 0.0920° W)
  • 'Berlin' → (52.5575° N, 13.2097° E)
  • 'Amsterdam' → (52.3481° N, 4.9139° E)

────────────────────────────────────────────────────────────────────────────────────────────────────
[边界] 4.3 嵌套地点
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The office is located in Austin, Texas, United States, near the University of Texas campus.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: near the University of Texas campus [type=value_error, input_value='near the University of Texas campus', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

────────────────────────────────────────────────────────────────────────────────────────────────────
[边界] 4.4 中文地名
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: The meeting will be held in Beijing, China on December 1, 2024.

时间实体 (1 个):
  • 'December 1, 2024' → 2024-12-01 [date]

空间实体 (2 个):
  • 'Beijing' → (39.9057° N, 116.3913° E)
  • 'China' → (35.0001° N, 104.9999° E)

────────────────────────────────────────────────────────────────────────────────────────────────────
[边界] 4.5 多重歧义
────────────────────────────────────────────────────────────────────────────────────────────────────
Input: Cambridge researchers met with Cambridge colleagues to discuss the Cambridge study.

❌ 错误: 1 validation error for TemporalEntity
normalized
  Value error, Invalid ISO 8601 format: Cambridge researchers met with Cambridge colleagues to discuss the Cambridge study. [type=value_error, input_value='Cambridge researchers me...ss the Cambridge study.', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error

====================================================================================================
测试结果汇总
====================================================================================================

总体统计:
  总测试数: 35
  成功: 25 (71.4%)
  错误: 10 (28.6%)

分类统计:
  [时间] 10/10 (100.0%)
  [空间] 4/10 (40.0%)
  [联合] 8/10 (80.0%)
  [边界] 3/5 (60.0%)

时间实体提取:
  总计: 35 个
  平均: 1.4 个/测试

空间实体提取:
  总计: 36 个
  平均: 1.4 个/测试

====================================================================================================
测试完成!
====================================================================================================
