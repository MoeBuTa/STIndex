# ==============================================================================
# STIndex Data Warehouse Configuration
# ==============================================================================
# Configuration for file-based warehouse (JSON, Parquet, GeoJSON)
# No database server required - uses DuckDB for SQL queries on files
# ==============================================================================

# Storage settings
storage:
  # Base directory for warehouse files
  base_dir: "data/warehouse"

  # Storage format for chunks
  # Options: jsonl (JSON Lines), parquet (Apache Parquet)
  # - jsonl: Human-readable, good for debugging, slower queries
  # - parquet: Columnar format, fast queries, smaller files
  primary_format: "jsonl"

  # Enable Parquet export for faster queries
  # If true, automatically exports to Parquet after each document save
  auto_export_parquet: false

  # GeoJSON settings for spatial data
  geojson:
    enabled: true
    filename: "events.geojson"

# Indexing settings
indexing:
  # Enable inverted indexes for fast filtering
  enabled: true

  # Index types to maintain
  temporal_index: true
  spatial_index: true

# Query engine settings
query:
  # Query engine backend
  # Options: duckdb (SQL), pandas (DataFrame)
  engine: "duckdb"

  # DuckDB settings
  duckdb:
    # Memory limit for DuckDB
    memory_limit: "2GB"

    # Number of threads
    threads: 4

    # Enable spatial extension
    enable_spatial: true

# Chunk labeling settings
labeling:
  # Enable hierarchical label generation
  enable_hierarchies: true

  # Temporal hierarchy settings
  temporal:
    # Date range validation
    min_year: 1900
    max_year: 2100

  # Spatial hierarchy settings
  spatial:
    # Enable reverse geocoding for full hierarchy
    enable_reverse_geocoding: false

# Export settings
export:
  # Default export directory
  output_dir: "data/warehouse/exports"

  # Available formats
  formats:
    - json
    - jsonl
    - csv
    - parquet
    - geojson

  # Include metadata in exports
  include_metadata: true

# Data quality settings
quality:
  # Minimum confidence threshold for loading
  min_confidence: 0.0

  # Skip chunks with no dimensional entities
  skip_empty_chunks: false

  # Validation rules
  validation:
    # Validate coordinates are within valid ranges
    validate_coordinates: true

    # Validate ISO 8601 temporal values
    validate_temporal: true

# Logging settings
logging:
  # Log level (DEBUG, INFO, WARNING, ERROR)
  level: "INFO"

  # Log slow queries (queries taking longer than threshold)
  log_slow_queries: true
  slow_query_threshold: 1.0  # seconds

# ==============================================================================
# LEGACY: PostgreSQL Settings (deprecated, kept for reference)
# ==============================================================================
# To use PostgreSQL-based warehouse, use the DimensionalWarehouseETL class
# from stindex.warehouse.etl instead of FileBasedWarehouse

# database:
#   connection_string: "postgresql://stindex:stindex@localhost:5432/stindex_warehouse"
#   pool:
#     min_size: 1
#     max_size: 10
#     timeout: 30
